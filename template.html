{{define "message"}}
{{.Title}}
<ul>
    {{range $key, $value := .Header}}
    {{range $value}}
    <li>
        {{ $key }}: {{ . }}
    </li>
    {{end}}
    {{end}}
</ul>
{{ $id := uid }}
<div id="{{$id}}" class="tabs">
    <input id="{{$id}}_raw" type="radio" name="{{$id}}" checked="{{if eq .BodyRaw .BodyJson}}checked{{end}}"
           onchange="UpdateTab('{{$id}}')"/>
    <label for="{{$id}}_raw" class="{{if eq .BodyRaw .BodyJson}}checked{{end}}">RAW</label>
    {{if ne .BodyRaw .BodyJson }}
    <input id="{{$id}}_json" type="radio" name="{{$id}}" checked="checked" onchange="UpdateTab('{{$id}}')"/>
    <label for="{{$id}}_json">Pretty JSON</label>
    {{end}}
    <div style="clear:both"></div>
    <div class="tab_content">
        <pre id="{{$id}}_raw_tab" style="{{if ne .BodyRaw .BodyJson}}display: none{{end}}">{{.BodyRaw}}</pre>
        {{if ne .BodyRaw .BodyJson }}
        <pre id="{{$id}}_json_tab">{{.BodyJson}}</pre>
        {{end}}
    </div>
</div>
{{end}}

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Результат тестирования</title>
    <style type="text/css">
        table.diff {
            background-color: #999;
            border-spacing: 1px;
        }

        .diff th {
            background-color: #eee;
        }

        .diff tr {
            background-color: #fff;
            border-bottom: 1px solid black;
        }

        .diff .line-num {
            width: 20px;
            background-color: #eee;
            font-family: monospace;
            word-wrap: normal;
        }

        .diff .line-num:first-child {
            text-align: right;
        }

        .diff .added {
            background-color: #afa;
        }

        .diff .deleted {
            background-color: #faa;
        }

        pre {
            white-space: pre-wrap;
        }

        .tabs {
            position: relative;
            width: 100%;
        }

        .tabs label {
            color: #555;
            cursor: pointer;
            display: block;
            float: left;
            margin-right: 2px;
            border: 1px solid #999;
        }

        .tabs input:checked + label {
            border-bottom: 1px solid #fff;
        }

        .tabs input {
            display: none;
        }

        .tab_content {
            background: #fff;
            margin: -1px 0 0 0;
            border: 1px solid #999;
        }
    </style>
    <script>

        function UpdateTab(id) {
            document.getElementById(id)
                .querySelectorAll("input")
                .forEach(function (item, i, arr) {
                    var tab = document.getElementById(item.id + "_tab");
                    tab.style.display = item.checked ? "" : "none";
                });
        }

    </script>
</head>
<body>
<h1>Результат тестирования</h1>
{{range .Reports}}
<h2>[{{ .Result }}] {{ .Checker.Name }}</h2>
<div>{{ .Checker.Description }}</div>
{{range .SkippedBy}}
<div>Skip: {{.}}</div>
{{end}}
{{range .Pass}}
<h3>Pass: {{.Name}}</h3>
{{range .Messages}}
<h3>URL: {{ .Url }}</h3>
<h4>Request</h4>
{{template "message" .Request}}

{{if ne .Delta "" }}
<h4>Delta</h4>
<table class="diff" width="100%">
    <thead>
    <tr>
        <th class="line-num"></th>
        <th>Ожидание</th>
        <th>Реальность</th>
        <th class="line-num"></th>
    </tr>
    </thead>
    <tbody>{{ .Delta }}</tbody>
</table>
{{end}}

<h4>Response</h4>
{{template "message" .Response}}

{{if .Example}}
<h4>Example</h4>
{{template "message" .Example}}
{{end}}
{{end}}
{{end}}
{{end}}
</body>
</html>
